define("common/confirm/confirm.js",function(require,exports,module){var template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="confirm-dialog" style="position:absolute;">\n    <a class="close" data-node="close">\n        <i class="icon icon-close"></i>\n    </a>\n    <div class="confirm-inner" data-node="inner">\n    </div>\n    <div class="btn-group">\n        <div class="btn cancel" data-node="cancel">取消</div>\n        <div class="btn" data-node="ok">确认</div>\n    </div>\n</div>';return __p},mask='<div class="mask"></div>',instanceObj=null,Confirm=function(){this.$el=$(template()),this.$mask=$(mask),this.$inner=this.$el.find('[data-node="inner"]'),this.inDom=!1,this.bindEvent()};Confirm.prototype={bindEvent:function(){this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this)),this.$el.on("click",'[data-node="cancel"]',$.proxy(this.onCancelClick,this)),this.$el.on("click",'[data-node="ok"]',$.proxy(this.onOkClick,this))},show:function(i){var n=$(window);this.curSpec=i||{},this.inDom||(this.$el.appendTo("body"),this.$mask.appendTo("body"),this.inDom=!0),this.$inner.html(this.curSpec.text||"确认执行当前操作？"),this.$el.show(),this.$mask.show(),this.$el.css({left:n.scrollLeft()+(n.width()-this.$el.width())/2,top:n.scrollTop()+(n.height()-this.$el.height())/2})},hide:function(){this.$el.hide(),this.$mask.hide()},onCancelClick:function(){this.hide()},onOkClick:function(){"function"==typeof this.curSpec.success&&this.curSpec.success(),this.hide()}},module.exports=function(){return instanceObj||(instanceObj=new Confirm),instanceObj}});
;define("common/feedbackDialog/feedbackDialog.js",function(require,exports,module){var template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="dialog feedback_dialog" style="position:fixed;">\n    <div class="dialog-header">\n        <h3>意见反馈</h3>\n    </div>\n    <div class="dialog-inner" data-node="inner">\n        <div class="feedback_panel">\n            <form>\n                <ul>\n                    <li>\n                        <p class="label">联系方式（必填）</p>\n                        <div class="input-group">\n                            <input class="email" placeholder="您的邮箱/QQ号" type="text" name="feedback-email">\n                        </div>\n                    </li>\n                    <li>\n                        <p class="label">您的意见（必填）</p>\n                        <div class="input-group">\n                            <textarea style="height:100px;" name="feedback-content" class="content" maxlength="140" placeholder="请填写您的意见，不超过140字"></textarea>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <input type="submit" class="submit-btn" value="提交">\n                            <span class="msg" data-node="msg"></span>\n                            <a data-node="close" class="close" href="javascript:;">[关闭]</a>\n                        </div>\n                    </li>\n                </ul>\n            </form>\n        </div>\n    </div>\n</div>';return __p},instanceObj=null,MESSAGE={success:"已提交,感谢您的意见",fail:"提交错误,请稍后重试",mail_error:"请输入正确的联系方式",content_error:"请输入您的意见",content_length_error:"意见长度超出限制"},MAX_LENGTH=280,FeedbackDialog=function(){this.$el=$(template()),this.$el.appendTo("body"),this.$email=this.$el.find('[name="feedback-email"]'),this.$content=this.$el.find('[name="feedback-content"]'),this.$msg=this.$el.find('[data-node="msg"]'),this.showing=!1,this.bindEvent()};FeedbackDialog.prototype={bindEvent:function(){this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this)),this.$el.on("submit","form",$.proxy(this.onFormSubmit,this))},showMsg:function(e){this.msgTimer&&clearTimeout(this.msgTimer);var t="success"!==e?"addClass":"removeClass";this.$msg[t]("error"),this.$msg.html(MESSAGE[e]),this.$msg.show();var i=this;this.msgTimer=setTimeout(function(){i.$msg.hide(),i.$msg.html("")},2e3)},show:function(){if(!this.showing){this.showing=!0;{$(window)}this.$el.show(),this.$el.animate({right:0},200)}},hide:function(){var e=this;this.$el.animate({right:-362},200,function(){e.$el.hide()}),this.showing=!1},onFormSubmit:function(e){e.preventDefault();var t=($(e.currentTarget),$.trim(this.$email.val())),i=$.trim(this.$content.val());return t.length<5?(this.$email.focus(),this.showMsg("mail_error")):!i||i.length>MAX_LENGTH?(this.$content.focus(),this.showMsg(i?"content_length_error":"content_error")):void $.ajax({url:"/post_message/",type:"POST",dataType:"json",data:{appkey:"web",uuid:t,content:"["+window.location.host+"]"+i},context:this,success:function(e){var t=this;return e=e||{},"success"!==e.message?this.showMsg("fail"):(this.showMsg("success"),this.$email.val(""),this.$content.val(""),void setTimeout(function(){t.hide()},2e3))}})}},module.exports=function(){return instanceObj||(instanceObj=new FeedbackDialog),instanceObj}});
;define("common/util/user.js",function(e,t,o){var n="/auth/login/",r="/user/info/",c="/auth/connect/?type=toutiao&platform=",i=null,s=!1,u="",a=function(e){if(e=e||{},!s){s=!0;var t=e.successCb||function(){},o=e.errorCb||function(){};$.ajax({url:n,type:"POST",dataType:"json",context:this,data:e.data,success:function(e){return s=!1,e=e||{},"success"!==e.message?o(e):(i=e.user,t(i),void listener.trigger("com.toutiao.user","change",i))},error:function(){s=!1,o({})}})}},f=function(e,t){var o=610,n=505,r=c+e,i=Math.max((window.screen.width-o)/2,0),s=Math.max((window.screen.height-n)/2,0),u="location=0,toolbar=0,status=0,resizable=0,scrollbars=1,width=610,height=505,top="+s+",left="+i,a=window.open(r,"login",u);try{a.focus()}catch(f){}l(a,t)},l=function(e,t){var o=!0;try{o=e.closed}catch(n){}o?(clearTimeout(arguments.callee.timer),g(t)):u=setTimeout(function(){l(e,t)},1e3)},g=function(e){e=e||{};var t=e.successCb||function(){},o=e.errorCb||function(){},n=$.cookie("sessionid");n?n&&i?t(i):h(e):o()},h=function(e){e=e||{};var t=e.successCb||function(){},o=e.errorCb||function(){};$.ajax({url:r,type:"get",cache:!1,dataType:"json",success:function(e){return e=e||{},"error"===e.message?o(e):(i=e,t(i),void listener.trigger("com.toutiao.user","change",i))},error:function(){o({})}})};o.exports={checkLogin:g,getUserInfo:h,loginByLoc:a,loginByOther:f}});
;define("common/loginDialog/loginDialog.js",function(require,exports,module){var user=require("common/util/user.js"),template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="login-dialog" style="position:absolute;">\n    <a class="btn" data-node="close">\n        <i class="icon icon-close"></i>\n    </a>\n    <div class="login-dialog-header">\n        <h3>邮箱登录</h3>\n    </div>\n    <div class="login-dialog-inner" data-node="inner">\n        <div class="login-pannel bottom-line">\n            <form data-node="loginForm" action="/auth/login/" method="POST">\n                <ul>\n                    <li>\n                        <div class="input-group">\n                            <div class="input">\n                                <label>邮箱</label>\n                                <input class="name" name="name_or_email" type="text" placeholder="请使用您的注册邮箱" autocomplete="off" spellcheck="false">\n                            </div>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <div class="input">\n                                <label>密码</label>\n                                <input class="password" name="password" type="password" data-node="password" placeholder="密码" autocomplete="off" spellcheck="false">\n                            </div>\n                        </div>\n                    </li>\n                    <li data-node="captchaBox" class="captcha-box">\n                        <div class="input-group">\n                            <div class="input">\n                                <input class="password" name="captcha" type="text" data-node="captcha" placeholder="验证码" autocomplete="off" spellcheck="false">\n                                <img data-node="captchaImg"/>\n                            </div>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <input type="checkbox" name="remember_me" checked="" style="vertical-align:top">\n                            <label for="remember_me" class="label">记住账号</label>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group" style="text-align: center;">\n                            <input type="submit" class="submit-btn" value="登录">\n                            <p class="error" data-node="errorMsg"></p>\n                        </div>\n                    </li>\n                </ul>\n            </form>\n        </div>\n        <div class="login-dialog-header">\n            <h3>合作网站帐号登录</h3>\n        </div>\n        <div class="">\n            <ul class="sns_login_list clearfix">\n                <li class="sinaweibo">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="sina_weibo" ga_event="login_sina_weibo">\n                        <i class="icon"></i>\n                        新浪微博\n                    </a>\n                </li>\n                <li class="qqweibo">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="qq_weibo" ga_event="login_tencnet_weibo">\n                        <i class="icon"></i>\n                        腾讯微博\n                    </a>\n                </li>\n                <li class="qzone">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="qzone_sns" ga_event="login_qqzone">\n                        <i class="icon"></i>\n                        QQ空间\n                    </a>\n                </li>\n                <li class="renren">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="renren_sns" ga_event="login_renren">\n                        <i class="icon"></i>\n                        人人网\n                    </a>\n                </li>\n                <li class="weixin">\n                    <a href="javascript:;" style="margin-right:0;" data-node="snsLogin" data-pid="weixin" ga_event="login_wechat">\n                        <i class="icon"></i>\n                        微信\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n';return __p},mask='<div class="mask"></div>',instanceObj=null,LoginDialog=function(){this.$el=$(template()),this.$pwd=this.$el.find('[data-node="password"]'),this.$errorMsg=this.$el.find('[data-node="errorMsg"]'),this.$captchaBox=this.$el.find('[data-node="captchaBox"]'),this.$captchaImg=this.$el.find('[data-node="captchaImg"]'),this.$captcha=this.$el.find('[data-node="captcha"]'),this.$form=this.$el.find(""),this.$mask=$(mask),this.curUser=null,this.bindEvent(),this.inDom=!1};LoginDialog.prototype={bindEvent:function(){this.$el.on("submit",'[data-node="loginForm"]',$.proxy(this.onFormSubmit,this)),this.$el.on("click",'[data-node="snsLogin"]',$.proxy(this.onSnsLoginClick,this)),this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this))},showError:function(n){var i=this;this.errorMsgTimer&&clearTimeout(this.errorMsgTimer),this.$errorMsg.html(n),this.$errorMsg.show(),this.errorMsgTimer=setTimeout(function(){i.$errorMsg.hide(),i.$errorMsg.html("")},2e3)},show:function(n){var i=$(window);this.curSpec=n||{},this.inDom||(this.$el.appendTo("body"),this.$mask.appendTo("body"),this.inDom=!0),this.$el.show(),this.$mask.show(),this.$el.css({left:i.scrollLeft()+(i.width()-this.$el.width())/2,top:i.scrollTop()+(i.height()-this.$el.height())/2})},hide:function(){this.$el.hide(),this.$mask.hide()},onFormSubmit:function(n){if(n.preventDefault(),!this.locked){this.locked=!0;var i=$(n.currentTarget),a=i.serialize(),e=this;user.loginByLoc({data:a,successCb:function(n){e.locked=!1,"function"==typeof e.curSpec.successCb&&e.curSpec.successCb(n),e.hide()},errorCb:function(n){e.locked=!1,e.$pwd.val(""),n=n||{};var i=n.data||{};e.showError(i.description||"登陆失败"),i.captcha?(e.$captcha.val(""),e.$captchaImg.attr("src","data:image/gif;base64,"+i.captcha),e.$captchaBox.show()):(e.$captcha.val(""),e.$captchaBox.hide()),"function"==typeof e.curSpec.errorCb&&e.curSpec.errorCb(n)}})}},onSnsLoginClick:function(n){var i=$(n.currentTarget),a=i.data("pid");this.hide(),user.loginByOther(a,this.curSpec)}},module.exports=function(){return instanceObj||(instanceObj=new LoginDialog),instanceObj}});
;define("common/toast/toast.js",function(require,exports,module){var template=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="mask"></div>\n<div class="toast">\n    <div class="toast-header"></div>\n    <div class="toast-body">\n        <i class="toast-status-icon '+(null==(__t=statusClass)?"":__t)+'"></i>\n        <p class="toast-message">'+(null==(__t=message)?"":_.escape(__t))+'</p>\n    </div>\n    <div class="toast-footer"></div>\n</div>';return __p};!function(t,s,e){t.fn.toast=function(s){var n=t(this),a=arguments[0],i="string"==typeof a,o=[].slice.call(arguments,1);n.each(function(){var n=t.extend(!0,{},t.fn.toast.settings,s),c=n.namespace,u="module-"+c,d=t(this),l=d.data(u),f="success"==n.status?n.className.success:n.className.fail,r=t(template({message:n.text,statusClass:f})).hide(),p={init:function(){p.createHtml(),p.event(),p.instantiate(),p.show(n.keep)},event:function(){r.on("click",function(){p.hide()})},unbind:function(){r.off("click")},createHtml:function(){t(n.appendTo).append(r)},hide:function(){r.hide()},show:function(s){s&&t.isNumeric(s)&&setTimeout(function(){p.hide()},s),r.show()},instantiate:function(){l=p,d.data(u,p)},destroy:function(){p.unbind(),r.remove(),d.removeData(u)},invoke:function(t){return"string"!=typeof t?!1:void l[t].apply(l,o)}};i?(l===e&&p.init(),p.invoke(a)):(l!==e&&l.invoke("destroy"),p.init())})},t.fn.toast.settings={name:"toast",namespace:"toast",appendTo:"body",text:"举报成功",keep:3e3,status:"success",className:{success:"toast-success",fail:"toast-fail"}}}(jQuery,window)});
;define("common/util/bdshare.js",function(t,e,n){var o="6649976",i="http://s.share.baidu.com/",a=function(){var t=(new Date).getTime(),e=(new Date).getTime()+1e3,n=(new Date).getTime()+3e3;return t.toString(32)+e.toString(32)+n.toString(32)},r=function(t,e){for(var n=t.length,o="",i=1;e>=i;i++){var a=Math.floor(n*Math.random());o+=t.charAt(a)}return o},c=function(){var t=(new Date).toString(36),e=r("0123456789abcdefghijklmnopqrstuvwxyz",3);return t+e};n.exports=function(t,e){e=$.extend(e||{});var n=a(),r=0,l="",u=document.title,d=e.wbuid||"",m=c(),s=(window.isAppPage?"app":"detail/list",encodeURIComponent(e.pic||"")),p=encodeURIComponent(e.url||""),h=encodeURIComponent(e.comment||""),f=encodeURIComponent(e.desc||"");"tsina"===t?u=(e.text||u)+(e.weibotext||l):("tqq"===t&&(e.text=e.text.replace("@今日头条","@headlineapp")),u=e.text||u),u=encodeURIComponent(u.substring(0,300));var g="?click=1&url="+p+"&uid="+o+"&to="+t+"&type=text&relateUid="+d+"&pic="+s+"&title="+u+"&key=&sign=on&desc="+f+"&comment="+h+"&searchPic=0&l="+n+"&linkid="+m+"&sloc=&apiType=0&buttonType="+r,w=i+g,b=i+"commit"+g+"&t="+Math.random(),v=function(){var t=[];return function(e){var n=t.push(new Image)-1;t[n].onload=function(){t[n]=t[n].onload=null},t[n].src=e}}();setTimeout(function(){v(b)},1500),window.open(w,"_blank","height=500,width=700,left=0,toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no,status=no")}});
;define("common/util/dateFormat.js",function(e,t,n){n.exports=function(e,t){var n,g={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(n in g)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?g[n]:("00"+g[n]).substr((""+g[n]).length)));return t}});
;define("common/util/fullscreen.js",function(e,l,n){n.exports={getFullScreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullScreen:function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}}});
;define("common/util/storage.js",function(e,t,n){var o=window.localStorage,r=function(e){return null===e||"undefined"==typeof e?e:decodeURIComponent(e)};if(o)return{get:function(e){return r(o.getItem(e))},set:function(e,t){o.setItem(e,encodeURIComponent(t))},del:function(e){o.removeItem(e)},clear:function(){o.clear()},getAll:function(){for(var e=o.length,t=null,n=[],r=0;e>r;r++)t=o.key(r),n.push(t+"="+this.getKey(t));return n.join("; ")}};if(window.ActiveXObject){var i=document.documentElement,c="localstorage";try{i.addBehavior("#default#userdata"),i.save("localstorage")}catch(u){}return{set:function(e,t){i.setAttribute(e,t),i.save(c)},get:function(e){return i.load(c),i.getAttribute(e)},del:function(e){i.removeAttribute(e),i.save(c)}}}return{get:function(e){for(var t=document.cookie.split("; "),n=t.length,o=[],i=0;n>i;i++)if(o=t[i].split("="),e===o[0])return r(o[1]);return null},set:function(e,t,n){n&&"object"==typeof n||(n=new Date,n.setDate(n.getDate()+1)),document.cookie=e+"="+encodeURIComponent(t)+"; expires="+n.toGMTString()},del:function(e){document.cookie=e+"=''; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},clear:function(){for(var e=document.cookie.split("; "),t=e.length,n=[],o=0;t>o;o++)n=e[o].split("="),this.deleteKey(n[0])},getAll:function(){return r(document.cookie.toString())}}});
;define("common/util/timeago.js",function(){!function(t){function e(e){var n=t.extend(o.settings,e),s=t.proxy(r,this);s(),n.refreshMillis>0&&setInterval(s,n.refreshMillis)}function r(){var e=n(this),r=e.datetime;return isNaN(r)||t(this).text(o.inWords(r)),this}function n(e){return e=t(e),e.data("timeago")||e.data("timeago",{datetime:o.datetime(e)}),e.data("timeago")}function s(t){return(new Date).getTime()-t.getTime()}function i(t){var e=new Date;return e.getMonth()>t.getMonth()||e.getDate()>t.getDate()}function a(t){return(new Date).getFullYear()>t.getFullYear()}Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in e)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[r]:("00"+e[r]).substr((""+e[r]).length)));return t};var o={settings:{refreshMillis:6e4,relative:!1,strings:{suffixAgo:"前",seconds:"刚刚",minute:"1分钟",minutes:"%d分钟",hour:"1小时",hours:"%d小时",days:"%d天",months:"%d月",years:"%d年",numbers:[]},yearsAgoFormat:"yyyy-MM-dd",daysAgoFormat:"MM-dd hh:mm"},inWords:function(e){function r(e,r){var n=t.isFunction(e)?e(r,u):e,s=g.numbers&&g.numbers[r]||r;return n.replace(/%d/i,s)}var n=o.settings.relative;if(!n&&a(e))return e.format(this.settings.yearsAgoFormat);if(!n&&i(e))return e.format(this.settings.daysAgoFormat);var u=s(e),g=this.settings.strings,h=g.suffixAgo,d=Math.abs(u)/1e3,l=d/60,f=l/60,m=f/24,c=m/30,M=m/365;return words=60>d?r(g.seconds,Math.floor(d)):60>l?r(g.minutes,Math.floor(l)):24>f?r(g.hours,Math.floor(f)):30>m?r(g.days,Math.floor(m)):365>m?r(g.months,Math.floor(c)):r(g.years,Math.floor(M)),"刚刚"==words?words:words+h},parse:function(e){var r=t.trim(e);return r=r.replace(/\.\d+/,""),r=r.replace(/-/,"/").replace(/-/,"/"),r=r.replace(/T/," ").replace(/Z/," UTC"),r=r.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(r)},datetime:function(e){var r=t(e).attr(o.isTime(e)?"datetime":"title");return o.parse(r)},isTime:function(e){return"time"===t(e).get(0).tagName.toLowerCase()}};t.fn.timeago=function(t){return this.each(function(){e.call(this,t)}),this}}(window.jQuery||window.Zepto)});
;define("pagelet/nav/nav.js",function(require,exports,module){var loginDialog=require("common/loginDialog/loginDialog.js"),userTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a class="btn user-head" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/">\n    <img src="'+(null==(__t=avatar_url)?"":__t)+'">\n    <span>'+(null==(__t=name)?"":__t)+'</span>\n</a>\n<i class="line"></i>\n<div class="layer">\n    <ul>\n        <li><a ga_event="nav_my_pin" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/" class="layer-item">我的收藏</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/subscribe/" class="layer-item">我的订阅</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followers/" class="layer-item">我的粉丝</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followings/" class="layer-item">我的关注</a></li>\n        <li><a href="//web.toutiao.com/auth/logout/" class="layer-item">退出</a></li>\n    </ul>\n</div>';return __p};module.exports=Pagelet.extend({el:"#pagelet-nav",hasHotwords:!1,events:{"mouseenter $username":"showLayer","mouseenter $more":"showLayer","mouseleave $username":"hideLayer","mouseleave $more":"hideLayer","click $login":"onLoginClick","click $username":"forceStatic"},channels:{"com.toutiao.user change":"onUserChange"},init:function(e){this.spec=e||{};var a=this.spec.type||"";this.$dom[a]&&this.$dom[a].addClass("selected"),"#login"===window.location.hash&&loginDialog().show({successCb:function(){window.location.reload()}}),this.initHeaderNav()},showLayer:function(e){var a=this,t=$(e.currentTarget),n=t.data("node"),i=n+"hidetimer",o=n+"showtimer";this[i]&&clearTimeout(this[i]),this[o]=setTimeout(function(){a.$dom[n].addClass("show-layer")},300)},hideLayer:function(e){var a=this,t=$(e.currentTarget),n=t.data("node"),i=n+"hidetimer",o=n+"showtimer";this[o]&&clearTimeout(this[o]),this[i]=setTimeout(function(){a.$dom[n].removeClass("show-layer")},100)},onLoginClick:function(){loginDialog().show({successCb:function(){window.location.reload()}})},onUserChange:function(e,a){this.$dom.username.html(userTmpl(a))},forceStatic:function(e){var a,t;try{"a"!=$(e.target)[0].tagName.toLocaleLowerCase()?(a=$(e.target).closest("a"),t=a.find("span"),"未激活用户"==t.html()&&e.preventDefault()):(a=$(e.target),t=a.find("span"),t&&"未激活用户"==t.html()&&e.preventDefault())}catch(e){}},initHeaderNav:function(){try{var e=$("#pagelet-nav .username-box"),a=e.find(".user-head span"),t=e.find(".layer-item");if("未激活用户"==a.html())for(var n=0;n<t.length;n++)"nav_loginout"!=t.eq(n).attr("ga_event")&&t.eq(n).remove()}catch(i){}}})});
;define("pagelet/feedback/feedback.js",function(i,o,n){var e=i("common/feedbackDialog/feedbackDialog.js");n.exports=Pagelet.extend({el:"#pagelet-feedback",events:{"click $back":"onBackClick","click $feedback":"onFeedbackClick"},init:function(){var i=this;this.showing=!1,this.$win=$(window),this.fbDialog=e(),$(document).on("click",function(){i.fbDialog.hide()}),this.fbDialog.$el.on("click",function(i){i.stopPropagation()});var o,n;this.$win.on("scroll",function(){o=i.$win.scrollTop(),n=i.$win.height(),!i.showing&&o>n?(i.$el.show(),i.showing=!0):i.showing&&n>=o&&(i.$el.hide(),i.showing=!1)})},onBackClick:function(){window.scrollTo(0,0)},onFeedbackClick:function(i){i.stopPropagation(),this.fbDialog.showing?this.fbDialog.hide():this.fbDialog.show()}})});
;define("pagelet/nnav/nnav.js",function(require,exports,module){var loginDialog=require("common/loginDialog/loginDialog.js"),userTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a class="btn user-head user-item" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/">\n  <div class="user-image">\n    <img onload="this.style.opacity=1;" src="'+(null==(__t=avatar_url)?"":__t)+'">\n  </div>\n    <span>'+(null==(__t=name)?"":__t)+'</span>\n</a>\n<div class="layer">\n    <ul>\n        <li><a ga_event="nav_my_pin" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/" class="layer-item">我的收藏</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/subscribe/" class="layer-item">我的订阅</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followers/" class="layer-item">我的粉丝</a></li>\n        <li><a ga_event="nav_my_message" href="http://web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followings/" class="layer-item">我的关注</a></li>\n        <li><a ga_event="nav_loginout" href="http://web.toutiao.com/auth/logout/" class="layer-item">退出</a></li>\n    </ul>\n</div>\n';return __p},searchTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";for(var i=0;i<words.length;i++){var search_txt=words[i],no=i+1;__p+='\n<li class="search-item">\n	<a  ga_event="new_navsearch_hot" class="" data-node="searchItem" data-txt="'+(null==(__t=search_txt)?"":_.escape(__t))+'" href="javascript:;">\n		<i class="search-no search-no-'+(null==(__t=no)?"":__t)+'">'+(null==(__t=no)?"":__t)+'</i>\n		<span class="search-txt">'+(null==(__t=search_txt)?"":_.escape(__t))+"</span>\n	</a>\n</li>\n"}__p+=""}return __p},topbarHeight=24,pgcinfo_ajax="/user/pgc_info/",pgcinfo_entry='<a class="new-article right" href="http://mp.toutiao.com/new_article/" ga_event="nav_write" target="_blank">发文</a>',feedbackDialog=require("common/feedbackDialog/feedbackDialog.js"),HOT_WORDS_AJAX=/hot_words/,storage=require("common/util/storage.js"),isIE=/msie/i.test(navigator.userAgent),hotwords_random=[],searchTips="大家都在搜：";module.exports=Pagelet.extend({el:"#pagelet-nnav",events:{"mouseenter $more":"showLayer","mouseleave $more":"hideLayer","mouseenter $moreNav":"showLayer","mouseleave $moreNav":"hideLayer","click $addToFavorites":"onAddToFavoritesClick","submit $searchForm":"onSearchFormSubmit","click $login":"onLoginClick","mouseenter $username":"showLayer","mouseleave $username":"hideLayer","click $navFeedback":"onNavFeedbackClick","focusin $searchBox":"onSearchBoxFocus","focusout $searchBox":"onSearchBoxBlur","click $searchItem":"onSearchItemClick","click $searchInput":"onSearchInputClick"},channels:{"com.toutiao.user change":"onUserChange"},init:function(e){var t=this,a=e.isHomePage;if($(function(){$("#instantclick-bar").css("transform","translate(100%)"),$("#instantclick").css("opacity","0")}),$(window).on("scroll",function(){sTop=$(document).scrollTop(),sTop>topbarHeight&&!t.sticky?(t.sticky=!0,t.$el.addClass("scroll"),listener.trigger("com.toutiao.channels","scroll",!0)):topbarHeight>=sTop&&t.sticky&&(t.sticky=!1,t.$el.removeClass("scroll"),listener.trigger("com.toutiao.channels","scroll",!1))}),a){var o=window.external&&"addFavorite"in window.external||window.sidebar&&window.sidebar.addPanel;o&&this.$dom.addToFavorites.show()}this.showing=!1,this.fbDialog=feedbackDialog(),$(document).on("click",function(){t.fbDialog.hide()}),this.fbDialog.$el.on("click",function(e){e.stopPropagation()}),this.getHotwords()},showLayer:function(e){var t=this,a=$(e.currentTarget),o=a.data("node"),i=o+"hidetimer",s=o+"showtimer";this[i]&&clearTimeout(this[i]),this[s]=setTimeout(function(){t.$dom[o].addClass("show-layer")},100)},hideLayer:function(e){var t=this,a=$(e.currentTarget),o=a.data("node"),i=o+"hidetimer",s=o+"showtimer";this[s]&&clearTimeout(this[s]),this[i]=setTimeout(function(){t.$dom[o].removeClass("show-layer")},100)},onAddToFavoritesClick:function(){var e="http://toutiao.com",t="今日头条";try{window.external.AddFavorite(e,t)}catch(a){try{window.sidebar.addPanel(t,e,"")}catch(o){var i="Ctrl";-1!=navigator.userAgent.toLowerCase().indexOf("mac")&&(i="command"),alert("抱歉，您所使用的浏览器无法完成此操作。\n\n请使用快捷键"+i+"+D进行添加！")}}},onSearchFormSubmit:function(e){var t=this.$dom.searchInput,a=t.val(),o=a.slice(0,6);if(t.val()||e.preventDefault(),o===searchTips){var i=a.slice(6);t.val(i)}t.blur(),this.$dom.searchSubmit.blur(),setTimeout(function(){var e=Math.floor(10*Math.random())%10;t.val(searchTips+hotwords_random[e])},100)},onLoginClick:function(){loginDialog().show({successCb:function(){}})},onUserChange:function(e,t){var a=this;"1"!=a.$dom.userbox.data("in")&&(a.$dom.userbox.data("in",1),this.$dom.username.html(userTmpl(t)),$.ajax({url:pgcinfo_ajax,type:"get",cache:!1,dataType:"json",success:function(e){e=e||{},"success"===e.message&&e.data.is_pgc_author&&a.$dom.userbox.prepend(pgcinfo_entry)}}))},onNavFeedbackClick:function(e){e.stopPropagation(),this.fbDialog.showing?this.fbDialog.hide():(this.fbDialog.show(),window.gaqpush&&window.gaqpush("nav_feedback",""))},getHotwords:function(){$.ajax({url:HOT_WORDS_AJAX,type:"GET",cache:!1,context:this,dataType:"json",success:function(e){e=e||[],e.length&&(storage.set("hotwords",e.join("|")),hotwords_random=e),this.createSearch(e)}})},createSearch:function(e){if(this.hasHotwords=!!e.length,this.hasHotwords){var t={words:e};this.$dom.searchMenu.html(searchTmpl(t)),this.curHotword=e[0],this.$dom.searchInput.val(searchTips+this.curHotword)}},onSearchBoxFocus:function(e){var t=this,a=t.$dom.searchInput,o=a.val(),i=!1;if(isIE&&a.is(".item-clicked"))return void a.removeClass("item-clicked");var s=function(){var r=a.val();i||(i=o!==r),r&&i?t.hideLayer(e):t.showLayer(e),t.searchtimer=setTimeout(s,500)};s()},onSearchBoxBlur:function(e){this.searchtimer&&clearTimeout(this.searchtimer),this.hideLayer(e)},onSearchItemClick:function(e){var t=$(e.currentTarget),a=t.data("txt");this.$dom.searchInput.val(a).addClass("item-clicked"),this.$dom.searchForm.submit()},onSearchInputClick:function(){var e=this.$dom.searchInput.val();e===searchTips+this.curHotword&&this.$dom.searchInput.val("")}})});